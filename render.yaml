services:
    - type: web
      name: ai-nursing-tutor
      env: php
      buildCommand: composer install --no-dev && npm install && npm run build
      startCommand: php artisan migrate --force && apache2-foreground
      envVars:
          - key: APP_KEY
            generateValue: true
          - key: APP_ENV
            value: production
          - key: APP_DEBUG
            value: false
          - key: DB_CONNECTION
            value: pgsql
          - key: DATABASE_URL
            fromDatabase:
                name: nursing-db
                property: connectionString
          - key: ASSET_URL
            value: https://ai-nursing-tutor.vercel.app # Update this after Vercel deployment
          - key: LOG_CHANNEL
            value: errorlog

databases:
    - name: nursing-db
      plan: free
      region: oregon
